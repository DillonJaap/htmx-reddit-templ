<!-- Comment list + add new comment button -->
{{ define "comment-component" }}
<div id="comment-component" style="padding-top: 1em; padding-bottom: 1em;">
	<form hx-post="/comment/add" hx-target="#comment-list" hx-swap="beforeend">
		<textarea id="add-comment" name="comment" placeholder="new comment..."></textarea>
		<input type="hidden" name="post-id" value="{{.Post.ID}}">
		<input type="submit" value="Reply" style="
				width: 5em;
				height: 20%;
				padding: 0em;
				margin: 0em;
				box-shadow: none;
				background: none;
			">
	</form>
	<hr style="border-top: solid;">
	{{ template "comment-list" .Comments }}
</div>
{{ end }}

<!-- List of Comments -->
{{ define "comment-list" }}
<div id="comment-list">
	{{ range . }}
	{{ template "comment" . }}
	{{ end }}
</div>
{{ end }}

<!-- Individual Comment -->
{{ define "comment" }}
<div class="comment container" id="comment-{{ .ID }}" style="
			border-left: dotted;
			border-color: var(--secondary);
			margin-bottom: 0.75em;
			padding-left:  1.0em;
			padding-right: 0.0em;
	">
	<div class="desc primary" style="white-space: pre-wrap;">{{ .Description }}</div>

	<div role="button" hx-post="/comment/update/{{.ID}}" hx-target="#comment-{{ .ID }}" hx-swap="outerHTML" style="
				font-size: 0.8em;
				padding: 0em;
				border: none;
				background: none;
			">
		edit
	</div>
	<div role="button" hx-delete="/comment/delete/{{.ID}}" hx-target="#comment-{{ .ID }}" hx-swap="outerHTML" style="
				font-size: 0.8em;
				padding: 0em;
				border: none;
				background: none;
			">
		delete
	</div>
	{{ template "reply-box" . }}
	{{ template "reply-list" . }}
</div>
{{ end }}

<!-- Reply Box -->
{{ define "reply-box" }}
{{ if eq .ReplyBoxVisible true }}
<span id="reply-box-{{.ID}}">
	<div role="button" hx-trigger="click, hide from:body" hx-post="/reply/hide?id={{.ID}}"
		hx-target="#reply-box-{{.ID}}" hx-swap="outerHTML" style="
				font-size: 0.8em;
				padding: 0em;
				border: none;
				background: none;
			">
		hide
	</div>
	<form hx-post="/comment/reply/{{.ID}}" hx-target="#reply-list-{{.ID}}" hx-swap="beforeend">
		<textarea id="add-comment" name="comment" placeholder="new reply..."></textarea>
		<input type="submit" value="Add Comment">
	</form>
</span>
{{ else }}
<div id="reply-box-{{.ID}}" role="button" hx-post="/reply/show?id={{.ID}}" hx-target="#reply-box-{{.ID}}"
	hx-swap="outerHTML" style="
				font-size: 0.8em;
				padding: 0em;
				border: none;
				background: none;
			">
	reply
</div>
{{ end }}
{{ end }}

<!-- List of Replies -->
{{ define "reply-list" }}
<div id="reply-list-{{.ID}}" style="padding-top: 0.6em">
	{{ if .Replies }}
	{{ range .Replies }}
	{{ template "comment" . }}
	{{ end }}
	{{ end }}
</div>
{{ end }}
